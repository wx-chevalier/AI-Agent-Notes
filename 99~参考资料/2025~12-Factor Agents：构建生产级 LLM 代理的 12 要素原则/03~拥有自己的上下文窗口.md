# 拥有自己的上下文窗口

上下文窗口是 LLM 对过往交互的有限记忆。本原则主张主动且有策略地管理上下文，确保只保留与当前任务直接相关的信息，及时剔除无关内容，防止"上下文漂移"或信息冗余。高效的上下文管理不仅能提升 LLM 的性能，还能减少 token 消耗，让模型聚焦于关键细节。

![Own your context building](https://apframework.com/static/images/2025-07-08-12-Factor-Agents/image%202.png)

无需总是采用标准消息格式向 LLM 传递上下文。

> 在任何时刻，你给代理 LLM 的输入都是"这是目前为止发生的事情，下一步是什么？"

一切都关乎上下文工程。LLM 是无状态函数，只负责将输入转化为输出。要获得最佳输出，必须为其提供最优输入。

营造良好上下文环境包括：

- 明确的提示和指令
- 检索到的文档或外部数据（如 RAG）
- 过往状态、工具调用、结果或其他历史
- 相关但独立的历史/对话信息（记忆）
- 输出结构化数据类型的说明

上下文内容包括：提示、说明、RAG 文档、历史、工具调用、记忆等。

请记住：上下文窗口是你与 LLM 交互的主要界面。合理组织和呈现信息能显著提升代理性能。

# **理解笔记**

构建 Agent 过程中，为了使 LLM 拥有更好的效果，从提示词工程向情景工程转换，利用工程方法和系统思维，提供 LLM 所需的：

- 当前情况：当前背景、当前进展；
- 目标任务：分解目标、最终目标；
- 已有工具、手段；
- 已有信息：历史资料、过往记忆、过往案例；

上下文管理不仅仅是拼接历史消息，更要有选择性地组织和压缩信息，确保 LLM 只接收到与当前任务最相关的内容。

建议建立上下文构建的标准流程和模板，便于团队协作和复用。
